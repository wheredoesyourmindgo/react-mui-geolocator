{"version":3,"file":"index.modern.js","sources":["../src/MatGeolocator/MatGeolocator.tsx"],"sourcesContent":["import React, {useState, useMemo, useCallback} from 'react';\nimport {\n  Fab,\n  FabProps,\n  CircularProgress,\n  withStyles,\n  createStyles,\n  CircularProgressProps,\n} from '@material-ui/core';\nimport GpsFixedIcon from '@material-ui/icons/GpsFixed';\nimport clsx from 'clsx';\nimport green from '@material-ui/core/colors/green';\n\nconst DEFAULT_TIMEOUT = 15000;\n\ntype Props = {\n  onClick: (coords: GeolocationCoordinates) => void;\n  classes: any;\n  timeout?: number;\n  onGeolocateError?: (error: GeolocationPositionError) => void;\n  circularProgressProps?: Partial<CircularProgressProps>;\n} & Partial<FabProps>;\n\nconst styles = createStyles({\n  progress: {\n    color: green[500],\n    position: 'absolute',\n    top: -4,\n    left: -4,\n    zIndex: 1,\n  },\n});\n\nconst MatGeoLocator = ({\n  classes,\n  timeout = DEFAULT_TIMEOUT,\n  size = 'small',\n  onClick,\n  onGeolocateError,\n  circularProgressProps,\n  ...rest\n}: Props) => {\n  const [locating, setLocating] = useState(false);\n\n  /**\n   * Geo-locate user position. Timeout and error after 15 seconds; default is set to run indefinitely.\n   */\n  const locate = useCallback(() => {\n    setLocating(true);\n    // https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/Using_geolocation\n    navigator.geolocation.getCurrentPosition(\n      ({coords}) => {\n        setLocating(false);\n        onClick(coords);\n      },\n      (error) => {\n        setLocating(false);\n        onGeolocateError?.(error);\n      },\n      {enableHighAccuracy: false, maximumAge: 0, timeout: timeout}\n    );\n  }, [onClick, onGeolocateError, timeout]);\n\n  const progress = useMemo(() => {\n    const {className: classNameProp, ...props} = circularProgressProps ?? {};\n    return (\n      locating && (\n        <CircularProgress\n          size={48}\n          className={clsx([classes.progress, classNameProp])}\n          {...props}\n        />\n      )\n    );\n  }, [locating, circularProgressProps, classes]);\n\n  return (\n    <>\n      <Fab\n        size={size}\n        aria-label=\"geolocate control\"\n        onClick={locate}\n        {...rest}\n      >\n        <GpsFixedIcon />\n      </Fab>\n      {progress}\n    </>\n  );\n};\n\nexport default withStyles(styles)(MatGeoLocator);\n"],"names":["DEFAULT_TIMEOUT","withStyles","createStyles","progress","color","green","position","top","left","zIndex","_ref","classes","timeout","size","onClick","onGeolocateError","circularProgressProps","rest","locating","setLocating","useState","locate","useCallback","navigator","geolocation","getCurrentPosition","coords","error","enableHighAccuracy","maximumAge","useMemo","className","classNameProp","props","React","CircularProgress","clsx","Fab","aria-label","GpsFixedIcon"],"mappings":"kmBAaA,MAAMA,EAAkB,KA8ExB,MAAeC,EApEAC,EAAa,CAC1BC,SAAU,CACRC,MAAOC,EAAM,KACbC,SAAU,WACVC,KAAM,EACNC,MAAO,EACPC,OAAQ,KA8DGR,CA1DOS,QAACC,QACrBA,EADqBC,QAErBA,EAAUZ,EAFWa,KAGrBA,EAAO,QAHcC,QAIrBA,EAJqBC,iBAKrBA,EALqBC,sBAMrBA,KACGC,yFAEH,MAAOC,EAAUC,GAAeC,GAAS,GAKnCC,EAASC,EAAY,KACzBH,GAAY,GAEZI,UAAUC,YAAYC,mBACpB,EAAEC,OAAAA,MACAP,GAAY,GACZL,EAAQY,IAETC,IACCR,GAAY,SACZJ,GAAAA,EAAmBY,IAErB,CAACC,oBAAoB,EAAOC,WAAY,EAAGjB,QAASA,KAErD,CAACE,EAASC,EAAkBH,IAEzBT,EAAW2B,EAAQ,KACvB,cAA6Cd,EAAAA,EAAyB,IAA/De,UAAWC,KAAkBC,qBACpC,OACEf,GACEgB,gBAACC,KACCtB,KAAM,GACNkB,UAAWK,EAAK,CAACzB,EAAQR,SAAU6B,KAC/BC,KAIT,CAACf,EAAUF,EAAuBL,IAErC,OACEuB,gCACEA,gBAACG,KACCxB,KAAMA,EACNyB,aAAW,oBACXxB,QAASO,GACLJ,GAEJiB,gBAACK,SAEFpC"}